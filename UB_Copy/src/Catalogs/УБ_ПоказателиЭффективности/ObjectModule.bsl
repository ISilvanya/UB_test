#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ОбработчикиСобытий

Процедура ОбработкаЗаполнения(ДанныеЗаполнения, ТекстЗаполнения, СтандартнаяОбработка)
	
	Если ТипЗнч(ДанныеЗаполнения) = Тип("Структура") Тогда
		
		Если ДанныеЗаполнения.Свойство("ТипПоказателя") Тогда
			ТипПоказателя = ДанныеЗаполнения.ТипПоказателя;
			ИспользоватьНастройкуИзТипаПоказателя = Не ТипПоказателя.Матричный;
		КонецЕсли;
		
	КонецЕсли;
	
	Если Не ЭтотОбъект.ЭтоГруппа Тогда
		ЕдиницаИзмерения = Справочники.УБ_ЕдиницыИзмеренияПоказателей.рубли;
	КонецЕсли;
	
КонецПроцедуры

Процедура ОбработкаПроверкиЗаполнения(Отказ, ПроверяемыеРеквизиты)
	
	Если Не ЭтоГруппа Тогда
		
		Если НЕ ТипЗначенияПоказателя = "число" Тогда
			ОбщегоНазначенияКлиентСервер.УдалитьЗначениеИзМассива(ПроверяемыеРеквизиты, "ЕдиницаИзмерения");				
		КонецЕсли;
		
		Если ТипПоказателя.Матричный
			Или ИспользоватьНастройкуИзТипаПоказателя Тогда
			ОбщегоНазначенияКлиентСервер.УдалитьЗначениеИзМассива(ПроверяемыеРеквизиты, "ПоказательРасчетаЗарплаты");
		КонецЕсли;
		
		Если ТипПоказателя.Матричный Тогда
			ОбщегоНазначенияКлиентСервер.УдалитьЗначениеИзМассива(ПроверяемыеРеквизиты, "ВидРасценки");
		КонецЕсли;
		
		Если ОграничиватьМинимальноеЗначениеРезультата
			И ОграничиватьМаксимальноеЗначениеРезультата
			И МинимальноеЗначениеРезультата >= МаксимальноеЗначениеРезультата Тогда
			ОбщегоНазначения.СообщитьПользователю(
				НСтр("ru = 'Минимальное значение результата должно быть меньше максимального'"),
				Ссылка,
				,
				,
				Отказ);
		КонецЕсли;
		
		// Проверка корректности идентификатора
		
		Для Позиция = 1 По СтрДлина(Идентификатор) Цикл
			Если СтроковыеФункцииКлиентСервер.ЭтоРазделительСлов(КодСимвола(Идентификатор, Позиция)) Тогда
				ОбщегоНазначения.СообщитьПользователю(
					НСтр("ru = 'Идентификатор содержит недопустимые символы'"),
					,
					"Объект.Идентификатор",
					,
					Отказ);	
				Прервать;
			КонецЕсли;
		КонецЦикла;
		
		КодПервогоСимвола = КодСимвола(Идентификатор, 1);
		Если КодПервогоСимвола >= 48 И КодПервогоСимвола <= 57 Тогда
			ОбщегоНазначения.СообщитьПользователю(
				НСтр("ru = 'Идентификатор не может начинаться с цифры'"),
				,
				"Объект.Идентификатор",
				,
				Отказ);
		КонецЕсли;
		
		ПоказательПоИдентификатору = УБ_РасчетПоказателейЭффективности.ПоказательЭффективностиПоИдентификатору(Идентификатор);
		Если ПоказательПоИдентификатору <> Неопределено
			И ПоказательПоИдентификатору <> Ссылка Тогда
			ТекстСообщения = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
				НСтр("ru = 'Показатель с идентификатором %1 уже существует'"), Идентификатор);
			ОбщегоНазначения.СообщитьПользователю(ТекстСообщения,, "Объект.Идентификатор",, Отказ);
		КонецЕсли;
		
	КонецЕсли;
		
КонецПроцедуры

Процедура ПередЗаписью(Отказ)
	
	Если ОбменДанными.Загрузка Тогда
		Возврат;
	КонецЕсли;
	
КонецПроцедуры

Процедура ПриЗаписи(Отказ)
	
	РегистрыСведений.УБ_ЗависимостиПоказателейЭффективности.ЗаполнитьЗависимостиПоказателей(ЗависимыеПоказатели, Ссылка);

КонецПроцедуры
	
Процедура ПриКопировании(ОбъектКопирования)
		
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

Процедура ПроверкаСтатусаГрейда()
	
КонецПроцедуры

#КонецОбласти

#КонецЕсли